(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{122:function(e,t,a){"use strict";a.r(t);var o=a(6),i=a.n(o),r=a(27),s=a.n(r),n=(a(59),a(28)),l=a.n(n),p=a(29),d=a.n(p),c=(a(62),{name:"crop-modal",components:{VueCropper:d.a},data:function(){return{imgSrc:"",ratio:9/16,duration:15}},methods:{initData:function(e){this.imgSrc=e,this.$refs.cropper.replace(e)},initRate:function(e){this.ratio=e},handleOk:function(e){var t=this.$refs.cropper.getCroppedCanvas().toDataURL();this.$emit("handleCropImage",{img:t,duration:this.duration})}}}),u=a(1),v=Object(u.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{id:"image-crop-modal",title:"Crop your image","no-close-on-backdrop":"","no-close-on-esc":"",size:"lg"},on:{ok:e.handleOk},scopedSlots:e._u([{key:"modal-footer",fn:function(t){var o=t.ok,i=t.cancel;return[a("div",{staticClass:"w-100 pl-5 pr-2 d-flex align-items-center justify-content-between"},[a("div",[a("span",{staticClass:"mr-2"},[e._v("Duration : ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.duration,expression:"duration"}],attrs:{type:"number"},domProps:{value:e.duration},on:{input:function(t){t.target.composing||(e.duration=t.target.value)}}})]),e._v(" "),a("div",[a("b-button",{attrs:{variant:"danger"},on:{click:function(e){return i()}}},[e._v("Cancel")]),e._v(" "),a("b-button",{staticClass:"ml-2",attrs:{variant:"success"},on:{click:function(e){return o()}}},[e._v("Create Video")])],1)])]}}])},[a("vue-cropper",{ref:"cropper",attrs:{src:e.imgSrc,alt:"Source Image","aspect-ratio":e.ratio}})],1)}),[],!1,null,null,null).exports,m={name:"progress-modal",props:{progress:{type:Number,default:0},total:{type:Number,default:0},mode:{type:Number,default:0}},computed:{showText:function(){return 1===this.mode&&0===this.progress?"Creating video":this.progress===this.total?"Merging video":"".concat(this.progress," of ").concat(this.total," steps are completed...")}}},f=Object(u.a)(m,(function(){var e=this.$createElement,t=this._self._c||e;return t("b-modal",{attrs:{id:"progress-modal","hide-header":"","hide-footer":"","no-close-on-backdrop":"","no-close-on-esc":"",centered:"","body-bg-variant":"info","body-text-variant":"light"}},[t("div",{staticClass:"d-flex align-items-center justify-content-center"},[t("b-spinner",{staticClass:"mr-2",attrs:{label:"loading",variant:"light"}}),this._v(" "),t("h5",{staticClass:"text-center mb-0"},[this._v(this._s(this.showText))])],1)])}),[],!1,null,null,null).exports,h=a(11),g=a.n(h),b=a(30),y=a.n(b);function x(e,t,a,o,i,r,s){try{var n=e[r](s),l=n.value}catch(e){return void a(e)}n.done?t(l):Promise.resolve(l).then(o,i)}var _={name:"welcome",components:{FilePond:s()(l.a),CropModal:v,ProgressModal:f},data:function(){return{uploadFiles:[],video:"",image:"",pixelated:"",duration:15,baseUrl:"http://localhost",steps:5,progress:0,mode:0,serverOptions:{url:"".concat("http://localhost","/api/uploadVideo"),revert:null,process:{withCredentials:!1}},ratioType:"portrait",ratioTypes:[{text:"Portrait (9 : 16)",value:"portrait"},{text:"Landscape (16: 9)",value:"landscape"}],mediaType:"video",mediaTypes:[{text:"Video",value:"video"},{text:"Image",value:"image"}]}},sockets:{connect:function(){},progress:function(e){this.progress=e.progress}},methods:{handleFilePondInit:function(){},handleProcessMedia:function(e,t){if(e)this.$bvToast.toast("Cannot upload the video",{title:"Warning",variant:"danger",solid:!0,autoHideDelay:2e3});else{var a=this.$refs.preview;this.video=t.serverId,a.src="".concat("http://localhost","/storage/").concat(t.serverId),a.load()}},pixelate:function(){var e=this;""!==this.video?(this.progress=0,this.mode=0,this.$bvModal.show("progress-modal"),g.a.post("/api/pixelate",{path:this.video,steps:this.steps,type:this.ratioType}).then((function(t){var a=e.$refs.pixelatedVideo;e.pixelated=t.data,a.src="".concat("http://localhost","/storage/").concat(t.data),a.load()})).catch((function(e){console.log(e)})).finally((function(){e.$bvModal.hide("progress-modal")}))):this.$bvToast.toast("Upload video first",{title:"Warning",variant:"danger",solid:!0,autoHideDelay:2e3})},resetUploader:function(){this.$refs.uploader.removeFiles()},onCropImage:function(e){var t,a=this;return(t=i.a.mark((function t(){var o,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(o=new FormData).append("file",e.img),o.append("duration",e.duration),t.next=5,y.a.fire({title:"Do you want to create pixelate together?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Create Both",denyButtonText:"Create Origin"});case 5:if(r=t.sent,o.append("scaleType",a.ratioType),o.append("steps",a.steps),!r.isConfirmed){t.next=13;break}o.append("pixelate",1),a.mode=0,t.next=20;break;case 13:if(!r.isDenied){t.next=18;break}o.append("pixelate",0),a.mode=1,t.next=20;break;case 18:return a.$bvToast.toast("Creating video is canceled",{title:"Warning",variant:"danger",solid:!0,autoHideDelay:2e3}),t.abrupt("return");case 20:a.progress=0,a.$bvModal.show("progress-modal"),g.a.post("/api/uploadImage",o).then((function(e){var t=a.$refs.preview;if(a.video=e.data.original,t.src="".concat("http://localhost","/storage/").concat(a.video),t.load(),r.isConfirmed){var o=a.$refs.pixelatedVideo;a.pixelated=e.data.pixelated,o.src="".concat("http://localhost","/storage/").concat(a.pixelated),o.load()}})).catch((function(e){console.log(e)})).finally((function(){a.$bvModal.hide("progress-modal")}));case 23:case"end":return t.stop()}}),t)})),function(){var e=this,a=arguments;return new Promise((function(o,i){var r=t.apply(e,a);function s(e){x(r,o,i,s,n,"next",e)}function n(e){x(r,o,i,s,n,"throw",e)}s(void 0)}))})()},cropImage:function(e){var t=this;if(0!==e.target.files.length){var a=e.target.files[0],o=new FileReader;this.$bvModal.show("image-crop-modal"),"portrait"===this.ratioType?this.$refs.cropperRef.initRate(9/16):this.$refs.cropperRef.initRate(16/9),o.onload=function(e){t.$refs.cropperRef.initData(e.target.result)},o.readAsDataURL(a)}},onClickImage:function(){this.$refs.files=(new DataTransfer).files,this.$refs.uploadImageRef.click()}}},w=(a(64),Object(u.a)(_,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"page-welcome"}},[a("div",{staticClass:"container"},[a("b-row",[a("b-col",{attrs:{md:"4"}},[a("h4",[e._v("Select your video type")]),e._v(" "),a("b-form-radio-group",{attrs:{id:"ratio-type",options:e.ratioTypes,name:"ratio-type"},model:{value:e.ratioType,callback:function(t){e.ratioType=t},expression:"ratioType"}}),e._v(" "),a("hr"),e._v(" "),a("h4",{staticClass:"mt-4"},[e._v("Select your type")]),e._v(" "),a("b-form-radio-group",{attrs:{id:"media-type",options:e.mediaTypes,name:"media-type"},model:{value:e.mediaType,callback:function(t){e.mediaType=t},expression:"mediaType"}}),e._v(" "),a("hr"),e._v(" "),"video"===e.mediaType?a("div",[a("h4",{staticClass:"mt-5"},[e._v("Import your video file")]),e._v(" "),a("file-pond",{ref:"uploader",staticClass:"mt-4",attrs:{name:"media-upload","label-idle":"<h3>Drop files here...</h3><h5 class='text-danger'>*Video should be at least 10 seconds.</h5>","allow-multiple":!1,"allow-revert":!1,"accepted-file-types":"video/mp4",server:e.serverOptions,files:e.uploadFiles},on:{init:e.handleFilePondInit,processfile:e.handleProcessMedia}}),e._v(" "),a("b-button",{attrs:{variant:"danger"},on:{click:e.resetUploader}},[e._v("Reset")])],1):a("div",[a("h4",{staticClass:"mt-5"},[e._v("Import your image file")]),e._v(" "),a("b-button",{attrs:{variant:"info"},on:{click:e.onClickImage}},[e._v("Load Image")])],1),e._v(" "),a("hr"),e._v(" "),a("h4",{staticClass:"mt-5"},[e._v("Input your pixelate steps")]),e._v(" "),a("b-form-input",{attrs:{type:"number"},model:{value:e.steps,callback:function(t){e.steps=t},expression:"steps"}}),e._v(" "),a("b-button",{staticClass:"mt-4",attrs:{variant:"success"},on:{click:e.pixelate}},[e._v("Pixelate")])],1),e._v(" "),a("b-col",{attrs:{md:"8"}},[a("b-row",[a("b-col",{attrs:{md:"portrait"===e.ratioType?6:12}},[a("h3",[e._v("Original Video")]),e._v(" "),a("div",{class:"portrait"===e.ratioType?"video-portrait":"video-landscape"},[a("video",{ref:"preview",attrs:{id:"preview-video",controls:""}},[a("source",{attrs:{src:e.video?e.baseUrl+"/storage/"+e.video:"",type:"video/mp4"}})])])]),e._v(" "),a("b-col",{class:"portrait"===e.ratioType?"mt-0":"mt-3",attrs:{md:"portrait"===e.ratioType?6:12}},[a("h3",[e._v("Pixelated Video")]),e._v(" "),a("div",{class:"portrait"===e.ratioType?"video-portrait":"video-landscape"},[a("video",{ref:"pixelatedVideo",attrs:{id:"pixelated-video",controls:""}},[a("source",{attrs:{src:e.pixelated?e.baseUrl+"/storage/"+e.pixelated:"",type:"video/mp4"}})])])])],1)],1)],1)],1),e._v(" "),a("crop-modal",{ref:"cropperRef",on:{handleCropImage:e.onCropImage}}),e._v(" "),a("progress-modal",{ref:"progressRef",attrs:{progress:Number(e.progress),total:Number(e.steps),mode:Number(e.mode)}}),e._v(" "),a("input",{ref:"uploadImageRef",attrs:{type:"file",accept:"image/png, image/jpeg",id:"image-upload",hidden:""},on:{change:e.cropImage}})],1)}),[],!1,null,null,null));t.default=w.exports},26:function(e,t,a){var o=a(65);"string"==typeof o&&(o=[[e.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(9)(o,i);o.locals&&(e.exports=o.locals)},64:function(e,t,a){"use strict";a(26)},65:function(e,t,a){(e.exports=a(8)(!1)).push([e.i,"#page-welcome{padding:50px}#page-welcome .filepond--credits{display:none!important}#page-welcome .video-portrait{width:100%;padding-top:170%;position:relative}#page-welcome .video-landscape{width:100%;padding-top:56.25%;position:relative}#page-welcome video{width:100%;height:100%;position:absolute;top:0;left:0}",""])}}]);